"use strict";(self.webpackChunkabz_agency=self.webpackChunkabz_agency||[]).push([[14],{588:(e,r,t)=>{t.r(r),t.d(r,{CreateUser:()=>j});var a=t(540),i=t(72),s=t.n(i),n=t(825),o=t.n(n),c=t(659),l=t.n(c),p=t(56),d=t.n(p),u=t(159),x=t.n(u),_=t(113),h=t.n(_),m=t(713),f={};f.styleTagTransform=h(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=o(),f.insertStyleElement=x(),s()(m.A,f),m.A&&m.A.locals&&m.A.locals;var g=t(832);const b=t.p+"0d3202ba11b04fa7364b.svg";var w=t(848);const j=({positions:e,token:r,addUser:t})=>{const[i,s]=(0,a.useState)("Upload your photo"),[n,o]=(0,a.useState)(!1),[c,l]=(0,a.useState)(!1),[p,d]=(0,a.useState)({name:"",email:"",phone:"",position_id:"",photo:null}),[u,x]=(0,a.useState)({}),[_,h]=(0,a.useState)({name:!1,email:!1,phone:!1}),m=(e,r)=>{switch(e){case"name":if(r.length<2||r.length>60)return"Username should contain 2-60 characters.";break;case"email":if(r.length<6||r.length>100)return"Email should be 6-100 characters.";if(!/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+))$/.test(r))return"User email, must be a valid email according to RFC2822";break;case"phone":if(!/^[\+]{0,1}380([0-9]{9})$/.test(r))return"User phone number. Number should start with code of Ukraine +380 and have 9 digits after it.";break;case"position_id":if(!r||Number(r)<1)return"Position is required.";break;case"photo":return r&&["image/jpeg","image/jpg"].includes(r.type)?r.size>5242880?"Photo must be <= 5MB":new Promise(e=>{const t=new Image;t.onload=()=>{t.width<70||t.height<70?e("Minimum size of photo is 70x70px"):e("")},t.src=URL.createObjectURL(r)}):"Invalid photo format.";default:return""}return""},f=async e=>{const{name:r,value:t,files:a}=e.target;let i="photo"===r?a?.[0]:t;if("phone"===r&&(i=i.replace(/[^\d]/g,""),i&&"+"!==i[0]&&(i="+"+i)),d(e=>({...e,[r]:i})),"photo"===r&&a[0]){s(a[0].name),o(!0);const e=await m(r,a[0]);x(t=>{const a={...t};return e?a[r]=e:delete a[r],a}),o(!1)}else{const e=m(r,i||"");x(t=>{const a={...t};return e?a[r]=e:delete a[r],a})}},j=!p.name||!p.email||!p.phone||!p.position_id||!p.photo||Object.values(u).some(e=>e)||n;return(0,w.jsx)("section",{id:"sign-up",className:"create-user",children:(0,w.jsxs)("div",{className:"create-user__container",children:[c&&(0,w.jsx)("div",{className:"create-user__success",children:(0,w.jsxs)("div",{className:"create-user__success__message",children:[(0,w.jsx)("h1",{children:"User successfully registered"}),(0,w.jsx)("img",{src:b,alt:"Success",className:"create-user__success__img"})]})}),(0,w.jsx)("h1",{children:"Working with POST request"}),(0,w.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a={};for(const[e,r]of Object.entries(p)){const t=await m(e,r);t&&(a[e]=t)}if(Object.keys(a).length)return void x(a);const i=new FormData;Object.entries(p).forEach(([e,r])=>i.append(e,r));const n=await fetch(`${g.t}/users`,{method:"POST",headers:{Token:r},body:i}),o=await n.json();if(o.success){const e=await fetch(`${g.t}/users/${o.user_id}`),r=await e.json();t(r.user),l(!0),setTimeout(()=>l(!1),5e3),d({name:"",email:"",phone:"",position_id:"",photo:null}),s("Upload your photo"),x({})}else x(o.fails||{general:o.message})},className:"create-user__form",children:[["name","email","phone"].map(e=>(0,w.jsxs)("div",{className:"create-user__input-container",children:[(0,w.jsx)("input",{className:"create-user__input "+(u[e]?"create-user__input__error":""),type:"email"===e?"email":"phone"===e?"tel":"text",name:e,required:!0,autoComplete:"off",value:p[e],onChange:f,onFocus:()=>(e=>{h(r=>({...r,[e]:!0}))})(e),onBlur:()=>(e=>{p[e]||h(r=>({...r,[e]:!1}))})(e),maxLength:"phone"===e?"19":void 0}),(0,w.jsx)("span",{className:"create-user__floating-label "+(_[e]||p[e]?"create-user__floating-label--active":""),children:e.charAt(0).toUpperCase()+e.slice(1)}),(u[e]||!p[e])&&(0,w.jsx)("p",{className:_[e]||p[e]?"create-user__error":"create-user__example",children:_[e]||p[e]?u[e]:"name"===e?"Example: Alice":"email"===e?"Example: alice.fonk@mail.com":"phone"===e?"Example: 380500740599":""})]},e)),(0,w.jsxs)("div",{className:"create-user__radio-container",children:[(0,w.jsx)("p",{className:"create-user__select",children:" Select your position"}),e.map(e=>(0,w.jsxs)("label",{className:"create-user__radio",children:[(0,w.jsx)("input",{type:"radio",required:!0,name:"position_id",value:e.id,checked:+p.position_id===e.id,onChange:f}),(0,w.jsx)("p",{children:e.name})]},e.id)),u.position_id&&(0,w.jsx)("p",{className:"create-user__error",children:u.position_id})]}),(0,w.jsxs)("div",{className:"create-user__file-upload",children:[(0,w.jsxs)("label",{className:"create-user__file-label "+(u.photo?"create-user__input--error":""),children:[(0,w.jsx)("span",{className:"create-user__file-button",children:"Upload"}),(0,w.jsx)("span",{className:"create-user__file-text",children:p.photo?p.photo.name:(0,w.jsx)("p",{className:"create-user__file-text-placeholder",children:"Upload your photo"})}),(0,w.jsx)("input",{className:"create-user__file-input",required:!0,type:"file",name:"photo",accept:"image/jpeg,image/jpg",onChange:f})]}),n&&(0,w.jsx)("div",{className:"loader",children:"Loading..."})]}),u.photo&&(0,w.jsx)("p",{className:"create-user__error",children:u.photo}),(0,w.jsx)("button",{type:"submit",className:"create-user__button",disabled:j,children:"Sign up"}),u.general&&(0,w.jsx)("div",{className:"create-user__error",children:u.general})]})]})})}},713:(e,r,t)=>{t.d(r,{A:()=>o});var a=t(601),i=t.n(a),s=t(314),n=t.n(s)()(i());n.push([e.id,".create-user__container{position:relative;z-index:1;margin:0 16px 100px 16px}@media(min-width: 768px){.create-user__container{margin:0 32px 100px 32px}}@media(min-width: 1024px){.create-user__container{margin:0 60px 100px 60px}}@media(min-width: 1170px){.create-user__container{max-width:1170px;margin:0 auto;padding-bottom:100px}}.create-user__success{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000}.create-user__success__message{background:#fff;padding:40px 60px;border-radius:10px;text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.2)}.create-user__success__img{max-width:328px;height:290px;margin-top:50px}.create-user__form{display:flex;flex-direction:column;align-items:center}.create-user__input-container{position:relative;margin-top:50px}.create-user__input{width:328px;height:54px;padding:14px 0 14px 16px;background-color:#f8f8f8;border-radius:4px;border:1px solid #d0cfcf;font-size:16px;line-height:1.625;box-sizing:border-box;transition:border-color .2s}.create-user__input__error{border:2px solid #cb3d40}@media(min-width: 768px){.create-user__input{width:380px}}.create-user__floating-label{position:absolute;left:16px;top:14px;color:#7e7e7e;font-size:16px;line-height:1.625;pointer-events:none;transition:.2s ease all}.create-user__floating-label--active{top:-11px;font-size:12px;line-height:1.666;background-color:#f8f8f8;padding:2px 4px}.create-user__radio-container{display:flex;flex-direction:column;align-items:flex-start;width:328px}@media screen and (min-width: 768px){.create-user__radio-container{width:380px}}.create-user__select{margin-top:43px}.create-user__radio{display:flex;margin-top:11px}.create-user__radio input{margin-right:12px;width:20px;height:20px}.create-user__photo{margin-top:47px;display:flex;flex-direction:row;align-items:center;justify-content:space-between}.create-user__photo__button{width:83px;height:54px;padding:14px 0;border-radius:4px;background-color:#f8f8f8;border:1px solid #000;margin:0}.create-user__file-upload{margin-top:47px;position:relative;height:54px}.create-user__file-label{display:flex;align-items:center;width:328px;overflow:hidden;cursor:pointer}@media screen and (min-width: 768px){.create-user__file-label{width:380px}}.create-user__file-button{display:flex;align-items:center;justify-content:center;border-radius:4px 0 0 4px;padding:13px 15px;border:1px solid rgba(0,0,0,.87)}.create-user__file-text{padding:13px 0 13px 16px;width:100%;border:1px solid #d0cfcf;border-radius:0 4px 4px 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.create-user__file-text-placeholder{color:#7e7e7e}.create-user__file-input{position:absolute;width:.1px;height:.1px;opacity:0;overflow:hidden;z-index:-1}.create-user__error{color:#cb3d40;font-size:12px;margin-top:4px;padding-left:16px}.create-user__example{color:#7e7e7e;font-size:12px;margin-top:4px;padding-left:16px}.create-user__button{margin-top:50px}.create-user__button:disabled{color:#fff;background-color:#b4b4b4;cursor:not-allowed}",""]);const o=n}}]);